/* モバイル最適化: iOSキーボードズーム防止とタップ領域改善 */

/* 全ての入力要素で16px以上のフォントサイズを確保 */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="number"],
input[type="tel"],
input[type="url"],
input[type="search"],
textarea,
select {
  font-size: 16px !important; /* iOSでのズーム防止 */
  min-height: 44px; /* タップ領域の最小高さ */
}

/* タップ可能な要素の最小サイズを確保 */
button,
a,
.clickable,
[role="button"],
[onclick] {
  min-height: 44px;
  min-width: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

/* タップ領域を視覚的サイズより大きくする */
button::before,
a::before,
.clickable::before {
  content: '';
  position: absolute;
  top: -8px;
  right: -8px;
  bottom: -8px;
  left: -8px;
  z-index: -1;
}

/* 100vh問題の修正: 動的ビューポート高さを使用 */
.full-height {
  height: 100vh;
  height: 100dvh; /* 動的ビューポート高さ（モバイル対応） */
}

.min-full-height {
  min-height: 100vh;
  min-height: 100dvh;
}

/* モーダル背景の固定改善 */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  -webkit-overflow-scrolling: touch; /* iOSスムーズスクロール */
}

/* iOS Safariでのposition:fixed揺れ防止 */
.fixed-header,
.fixed-footer {
  position: fixed;
  transform: translateZ(0); /* GPUアクセラレーション */
  -webkit-transform: translateZ(0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* スクロール時の背景固定 */
body.modal-open {
  position: fixed;
  width: 100%;
  overflow: hidden;
  -webkit-overflow-scrolling: auto;
}

/* タッチ操作の最適化 */
.draggable,
.chart-container {
  touch-action: pan-y; /* 縦スクロールのみ許可 */
}

.no-scroll {
  touch-action: none; /* スクロール無効化 */
}

/* ダークモードのコントラスト改善 */
@media (prefers-color-scheme: dark) {
  input,
  textarea,
  select {
    background-color: #1a1a1a;
    color: #ffffff;
    border-color: #333333;
  }
  
  button {
    background-color: #2a2a2a;
    color: #ffffff;
  }
}

/* セーフエリアの考慮（iPhone X以降） */
.safe-area-padding {
  padding-top: env(safe-area-inset-top);
  padding-right: env(safe-area-inset-right);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
}

/* 横画面時の調整 */
@media (orientation: landscape) and (max-height: 500px) {
  .header {
    position: sticky;
    top: 0;
    z-index: 100;
  }
  
  .full-height {
    height: auto;
    min-height: 100dvh;
  }
}