<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="BaseLog - 野球の記録と交流をひとつに。練習記録、動画共有、健康管理をサポートする野球専門SNS">
  
  <title>BaseLog - 野球の記録と交流をひとつに</title>
  
  <!-- Theme Color -->
  <meta name="theme-color" content="#2e7d46">
  
  <!-- iOS PWA設定 -->
  <!-- Androidでフルスクリーンモード有効化 -->
  <meta name="mobile-web-app-capable" content="yes">
  <!-- iOSでフルスクリーンモード有効化（ホーム画面追加時） -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!-- iOSステータスバーのスタイル（default/black/black-translucent） -->
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <!-- iOSホーム画面でのアプリ名 -->
  <meta name="apple-mobile-web-app-title" content="BaseLog">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/icon.svg">
  <!-- iOSホーム画面アイコン -->
  <link rel="apple-touch-icon" href="/icon.svg">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="BaseLog">
  <meta property="og:description" content="野球の記録と交流をひとつに">
  <meta property="og:image" content="/icon.svg">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="BaseLog">
  <meta name="twitter:description" content="野球の記録と交流をひとつに">
  <meta name="twitter:image" content="/icon.svg">
  
  <!-- Safari互換性のためのpolyfill -->
  <script>
    // Safari用のObject.assignポリフィル
    if (typeof Object.assign !== 'function') {
      Object.defineProperty(Object, 'assign', {
        value: function assign(target) {
          'use strict';
          if (target === null || target === undefined) {
            throw new TypeError('Cannot convert undefined or null to object');
          }
          var to = Object(target);
          for (var index = 1; index < arguments.length; index++) {
            var nextSource = arguments[index];
            if (nextSource !== null && nextSource !== undefined) {
              for (var nextKey in nextSource) {
                if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                  to[nextKey] = nextSource[nextKey];
                }
              }
            }
          }
          return to;
        },
        writable: true,
        configurable: true
      });
    }
  </script>
</head>
<body>
  <div id="root"></div>
  <!-- メインアプリケーション -->
  <script type="module" src="/src/main.jsx"></script>
  
  <!-- Service Worker登録（本番環境のみ） -->
  <script>
    // Vercelの本番環境でのみService Workerを有効化
    // localhost、127.0.0.1、または.vercel.appのプレビュー環境では無効化
    const isProduction = window.location.hostname.endsWith('.vercel.app') && 
                        !window.location.hostname.includes('-git-') && // Gitブランチのプレビュー
                        !window.location.hostname.includes('localhost') &&
                        !window.location.hostname.includes('127.0.0.1');
    
    if (isProduction) {
      console.log('[SW] 本番環境検出。Service Workerを登録します。');
      const script = document.createElement('script');
      script.src = '/register-sw.js';
      script.defer = true;
      document.body.appendChild(script);
    } else {
      console.log('[SW] 開発/プレビュー環境のため、Service Workerは無効化されています');
    }
  </script>
</body>
</html>